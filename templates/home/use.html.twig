{% extends 'base.html.twig' %}

{% block title %}
	page festival
{% endblock %}
{% block style %}
	rel="stylesheet" href="{{asset('css/admin.css')}}"
{% endblock %}

{% block body %}
	<div class="container">
		<h1>Bienvenue sur la page du festival
			{{festival.name}}
		</h1>
		<navbar class="navbar navbar-menu bg-primary">
			nav</navbar>
		<section class="important-section bg-danger">
			{% for notification in notifications %}
				{% if notification.important %}
					<div>{{notification.content}}
					</div>
				{% endif %}
			{% endfor %}
		</section>
		<section class="program-section border">
			<h2>
				Programme du jour :
			</h2>
		</section>
        <section>
            <h2>
                Billeterie
            </h2>
        </section>
		<section class="notification-section">
			{% for notification in notifications %}
				{% if notification.important == false %}
					<div>{{notification.content }}
					</div>
				{% endif %}
			{% endfor %}
		</section>
		<section class="map-section">
        <h1>Map</h1>

<p id="latitude"></p>
<p id="longitude"></p>

<div id="map" style="width: 100%; height: 500px;"></div>
</section>
<section class="faq-section">

<div id="accordion-collapse" data-accordion="collapse">
  <h2 id="accordion-collapse-heading-1">
    <button type="button" class="flex items-center justify-between w-full p-5 font-medium text-left text-gray-500 border border-b-0 border-gray-200 rounded-t-xl focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-800 dark:border-gray-700 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800" data-accordion-target="#accordion-collapse-body-1" aria-expanded="true" aria-controls="accordion-collapse-body-1">
      <span>Combien de temps avant un concert doit-on se présenter?</span>
      <svg data-accordion-icon class="w-6 h-6 rotate-180 shrink-0" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
    </button>
  </h2>
  <div id="accordion-collapse-body-1" class="hidden" aria-labelledby="accordion-collapse-heading-1">
    <div class="p-5 border border-b-0 border-gray-200 dark:border-gray-700 dark:bg-gray-900">
      <p class="mb-2 text-gray-500 dark:text-gray-400">
     Idéalement il vaut mieux arriver 30 min avant pour être sur d'avoir de la place</p>
      <p class="text-gray-500 dark:text-gray-400">
     En cas de forte affluence rien de sert de s'énerver, prenez patience 
     les concerts euvent accueillir tous les festivaliers.
      </p>
    </div>
  </div>
  <h2 id="accordion-collapse-heading-2">
    <button type="button" class="flex items-center justify-between w-full p-5 font-medium text-left text-gray-500 border border-b-0 border-gray-200 focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-800 dark:border-gray-700 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800" data-accordion-target="#accordion-collapse-body-2" aria-expanded="false" aria-controls="accordion-collapse-body-2">
      <span> Question 2</span>
      <svg data-accordion-icon class="w-6 h-6 shrink-0" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
    </button>
  </h2>
  <div id="accordion-collapse-body-2" class="hidden" aria-labelledby="accordion-collapse-heading-2">
    <div class="p-5 border border-b-0 border-gray-200 dark:border-gray-700">
      <p class="mb-2 text-gray-500 dark:text-gray-400">
      Réponse 2
      </p>
      <p class="text-gray-500 dark:text-gray-400">
      Réponse 2
      </p>
    </div>
  </div>
  <h2 id="accordion-collapse-heading-3">
    <button type="button" class="flex items-center justify-between w-full p-5 font-medium text-left text-gray-500 border border-gray-200 focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-800 dark:border-gray-700 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-800" data-accordion-target="#accordion-collapse-body-3" aria-expanded="false" aria-controls="accordion-collapse-body-3">
      <span>Question 3</span>
      <svg data-accordion-icon class="w-6 h-6 shrink-0" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
    </button>
  </h2>
  <div id="accordion-collapse-body-3" class="hidden" aria-labelledby="accordion-collapse-heading-3">
    <div class="p-5 border border-t-0 border-gray-200 dark:border-gray-700">
      <p class="mb-2 text-gray-500 dark:text-gray-400">
réponse 3      </p>
      <p class="mb-2 text-gray-500 dark:text-gray-400">
réponse 3      </p>
    
    </div>
  </div>
</div>

</section>
<script src="{{asset('js/mapStyles.js')}}"></script>
<script>
 var userLat, userLng;

    // Obtient la position de l'utilisateur
    function getLocation() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function(position) {
                userLat = position.coords.latitude;
                userLng = position.coords.longitude;
                document.getElementById('latitude').textContent = 'Latitude : ' + userLat;
                document.getElementById('longitude').textContent = 'Longitude : ' + userLng;
                // Initialise la carte après avoir obtenu la position de l'utilisateur
                initMap();
            });
        } else {
            console.log('La géolocalisation n\'est pas prise en charge par ce navigateur.');
            // Initialise la carte même si la géolocalisation n'est pas prise en charge
            initMap();
        }
    }

    getLocation();

    function initMap() {
        var center = {lat: userLat, lng: userLng};
        
        if (typeof userLat === "undefined" || typeof userLng === "undefined") {
            // Utilise la première localisation comme centre si la position de l'utilisateur n'est pas disponible
            center = new google.maps.LatLng({{ locations[0].latitude }}, {{  locations[0].longitude }});
        }
        
        var map = new google.maps.Map(document.getElementById('map'), {
            zoom: 15,
            center: center,
            styles: mapStyles
        });

        // Place un marqueur à la position de l'utilisateur
        if (typeof userLat !== "undefined" && typeof userLng !== "undefined") {
        var userMarker = new google.maps.Marker({
            position: new google.maps.LatLng(userLat, userLng),
            map: map,
            title: "Your Location",
            icon: {
            url: "{{asset('images/user.svg')}}", 
            scaledSize: new google.maps.Size(25, 25), 
            origin: new google.maps.Point(0,0),
            anchor: new google.maps.Point(0, 0)
            }
        });
    }
    {% for location in locations %}
        (function() {
            var marker = new google.maps.Marker({
                position: new google.maps.LatLng({{ location.latitude }}, {{ location.longitude}}),
                map: map,
                icon: {
                    url: "{{asset('images/restaurant.svg')}}",
                    scaledSize: new google.maps.Size(25, 25),
                    origin: new google.maps.Point(0,0),
                    anchor: new google.maps.Point(0, 0)
                }
            });

            var infowindow = new google.maps.InfoWindow({
                content: '<h3>{{ location.name|escape('js') }}</h3>'
            });

            marker.addListener('click', function() {
                infowindow.open(map, marker);

            });
        })();
    {% endfor %}

    }

    google.maps.event.addDomListener(window, 'load', getLocation);
    </script>
	</div>
{% endblock %}
